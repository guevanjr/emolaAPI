{"version":3,"sources":["../../src/security/ClientSSLSecurity.js"],"names":["g","require","fs","https","_","Security","ClientSSLSecurity","constructor","key","cert","ca","options","Buffer","isBuffer","readFileSync","Error","f","Array","isArray","addOptions","merge","agent","Agent","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AAEA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,cAAD,CAAf;;AACA,IAAIC,EAAE,GAAGD,OAAO,CAAC,IAAD,CAAhB;AAAA,IACIE,KAAK,GAAGF,OAAO,CAAC,OAAD,CADnB;AAAA,IAEIG,CAAC,GAAGH,OAAO,CAAC,QAAD,CAFf;AAAA,IAGII,QAAQ,GAAGJ,OAAO,CAAC,YAAD,CAHtB;;AAKA,MAAMK,iBAAN,SAAgCD,QAAhC,CAAyC;AAEvC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEE,EAAAA,WAAW,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAgBC,OAAhB,EAAyB;AAClC,UAAMA,OAAN;;AACA,QAAIH,GAAJ,EAAS;AACP,UAAII,MAAM,CAACC,QAAP,CAAgBL,GAAhB,CAAJ,EAA0B;AACxB,aAAKA,GAAL,GAAWA,GAAX;AACD,OAFD,MAEO,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAClC,aAAKA,GAAL,GAAWN,EAAE,CAACY,YAAH,CAAgBN,GAAhB,CAAX;AACD,OAFM,MAEA;AACL,cAAM,IAAIO,KAAJ,CAAUf,CAAC,CAACgB,CAAF,CAAI,iDAAJ,CAAV,CAAN;AACD;AACF;;AAED,QAAIP,IAAJ,EAAU;AACR,UAAIG,MAAM,CAACC,QAAP,CAAgBJ,IAAhB,CAAJ,EAA2B;AACzB,aAAKA,IAAL,GAAYA,IAAZ;AACD,OAFD,MAEO,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AACnC,aAAKA,IAAL,GAAYP,EAAE,CAACY,YAAH,CAAgBL,IAAhB,CAAZ;AACD,OAFM,MAEA;AACL,cAAM,IAAIM,KAAJ,CAAUf,CAAC,CAACgB,CAAF,CAAI,kDAAJ,CAAV,CAAN;AACD;AACF;;AAED,QAAIN,EAAJ,EAAQ;AACN,UAAIE,MAAM,CAACC,QAAP,CAAgBH,EAAhB,KAAuBO,KAAK,CAACC,OAAN,CAAcR,EAAd,CAA3B,EAA8C;AAC5C,aAAKA,EAAL,GAAUA,EAAV;AACD,OAFD,MAEO,IAAI,OAAOA,EAAP,KAAc,QAAlB,EAA4B;AACjC,aAAKA,EAAL,GAAUR,EAAE,CAACY,YAAH,CAAgBJ,EAAhB,CAAV;AACD,OAFM,MAEA;AACL,aAAKC,OAAL,GAAeD,EAAf;AACA,aAAKA,EAAL,GAAU,IAAV;AACD;AACF;AACF;;AAEDS,EAAAA,UAAU,CAACR,OAAD,EAAU;AAClBA,IAAAA,OAAO,CAACH,GAAR,GAAc,KAAKA,GAAnB;AACAG,IAAAA,OAAO,CAACF,IAAR,GAAe,KAAKA,IAApB;AACAE,IAAAA,OAAO,CAACD,EAAR,GAAa,KAAKA,EAAlB;;AACAN,IAAAA,CAAC,CAACgB,KAAF,CAAQT,OAAR,EAAiB,KAAKA,OAAtB;;AACAA,IAAAA,OAAO,CAACU,KAAR,GAAgB,IAAIlB,KAAK,CAACmB,KAAV,CAAgBX,OAAhB,CAAhB;AACD;;AApDsC;;AAuDzCY,MAAM,CAACC,OAAP,GAAiBlB,iBAAjB","sourcesContent":["// Copyright IBM Corp. 2016. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar g = require('../globalize');\nvar fs = require('fs')\n  , https = require('https')\n  , _ = require('lodash')\n  , Security = require('./security');\n\nclass ClientSSLSecurity extends Security {\n\n  /**\n   * activates SSL for an already existing client\n   *\n   * @module ClientSSLSecurity\n   * @param {Buffer|String}   key\n   * @param {Buffer|String}   cert\n   * @param {Buffer|String|Array}   [ca]\n   * @param {Object}          [options]\n   * @constructor\n   */\n  constructor(key, cert, ca, options) {\n    super(options);\n    if (key) {\n      if (Buffer.isBuffer(key)) {\n        this.key = key;\n      } else if (typeof key === 'string') {\n        this.key = fs.readFileSync(key);\n      } else {\n        throw new Error(g.f('{{key}} should be a {{buffer}} or a {{string}}!'));\n      }\n    }\n\n    if (cert) {\n      if (Buffer.isBuffer(cert)) {\n        this.cert = cert;\n      } else if (typeof cert === 'string') {\n        this.cert = fs.readFileSync(cert);\n      } else {\n        throw new Error(g.f('{{cert}} should be a {{buffer}} or a {{string}}!'));\n      }\n    }\n\n    if (ca) {\n      if (Buffer.isBuffer(ca) || Array.isArray(ca)) {\n        this.ca = ca;\n      } else if (typeof ca === 'string') {\n        this.ca = fs.readFileSync(ca);\n      } else {\n        this.options = ca;\n        this.ca = null;\n      }\n    }\n  }\n\n  addOptions(options) {\n    options.key = this.key;\n    options.cert = this.cert;\n    options.ca = this.ca;\n    _.merge(options, this.options);\n    options.agent = new https.Agent(options);\n  };\n}\n\nmodule.exports = ClientSSLSecurity;\n"],"file":"ClientSSLSecurity.js"}